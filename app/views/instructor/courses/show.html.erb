<script>
	$(function() {
		$('.lessons').sortable({
	      update: function( event, ui ) {
	        $.ajax({
	          type: 'PUT',
	          url: ui.item.data('update-url'),
	          dataType: 'json',
	          data: { lesson: { row_order_position: ui.item.index() } }
	        });
	      }
		});
	});
</script>

<script>
	$(function() {
		$('.sections').sortable({
	      update: function( event, ui ) {
	        $.ajax({
	          type: 'PUT',
	          url: ui.item.data('update-url-section'),
	          dataType: 'json',
	          data: { section: { row_order_position: ui.item.index() } }
	        });
	      }
		});
	});
</script>

<br />
<div class="booyah-box col-10 offset-1">
  <h1 class="text-center"><%= current_course.title %></h1>
  <br/>
  <%= image_tag current_course.image.to_s, class: 'img-fluid course_img' %>
  <br/>
  <br/>
  <%= link_to 'PREVIEW AS STUDENT', course_path(current_course), class: 'btn btn-warning float right' %>
  <br class="clr"/>
  
  <div class="text-center">
	  <%= link_to 'ADD A NEW SECTION', new_instructor_course_section_path(current_course), class: 'btn btn-primary' %>
  </div>
  <br/>
  
  <ul class="sections">
	  <% current_course.sections.rank(:row_order).each do |section| %>
	  <li class="section-li" data-update-url-section="<%= instructor_section_path(section) %>">
		  <div class="header">
			  <span class="fa fa-ellipsis-v"></span>
			  <%= section.title %>
		  </div>
	  <%= link_to 'NEW LESSON', new_instructor_section_lesson_path(section), class: 'btn btn-primary float-right' %>
	  <br class="clr"/>
	  <br class="clr"/>
	  <ul class="lessons">
		  <% section.lessons.rank(:row_order).each do |lesson| %>
		  <li data-update-url="<%= instructor_lesson_path(lesson) %>">
		  <div class="row">
			  <div class="col-1">
				  <br/>
				  <span class="fa fa-ellipsis-v"></span>
			  </div>
			  <div class="col-11">
				  <p>
				  <b><%= lesson.title %></b>
				  </p>
				  <p>
				  <%= lesson.subtitle %>
				  </p>
			  </div>
		  </div>
		  <br class="clr"/>
		  </li>
		  <% end %>
	  </ul>
	  <br class="clr" />
	  </li>
	  <% end %>
  </ul>
  
</div>
